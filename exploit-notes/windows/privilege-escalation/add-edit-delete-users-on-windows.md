---
title: Add/Edit/Delete Users on Windows
description: 
tags:
    - Privilege Escalation
    - Windows
refs:
date: 2024-04-01
draft: false
---

## Add New User

```powershell
net user /add <username> <password>
net user /add /domain <username> <password>
```

### with SecureString Password

```powershell
$Username = "John"
$Password = ConvertTo-SecureString "MyPassword123@" -AsPlainText -Force
$FullName = "John Doe"
$Description = "My new account"
$HomeDir = "C:\Users\John"

# Create new user
New-LocalUser -Name $Username -Password $Password -FullName $FullName -Description $Description -PasswordNeverExpires
# Add to "Users" local group
Add-LocalGroupMember -Group Users -Member $Username
```

Now reboot Windows computer and you can sign in the new account.

<br />

## Add User to Local Group

```powershell
# Add to the Administrators group.
net localgroup Administrators <username> /add

# Add to the WinRM group.
net localgroup "Remote Managment Users" <username> /add

# Add to the RDP group.
net localgroup "Remote Desktop Users" <username> /add
```

If we could add an user to the WinRM or RDP group, we can login **WinRM** or **RDP** with the user credential.

<br />

## Change User Password

```powershell
net user <username> <new-password>
```

<br />

## Delete User

```powershell
net user <username> /delete
```

<br />

## Delete User From Local Group

```powershell
# Delete from the Administrators group.
net localgroup Administrators <username> /delete

# Delete from the WinRM group.
net localgroup "Remote Management Users" <username> /delete
```
